create or replace PROCEDURE HRIS_MIG_DEPARTMENT
AS
V_DEPARTMENT_ID NUMBER;
V_STATUS CHAR(1 BYTE);
BEGIN


FOR V_DEPARTMENT_LIST IN (SELECT * FROM HR_DEPARTMENT_CODE WHERE GROUP_SKU_FLAG='I' ORDER BY DEPARTMENT_CODE)
LOOP

BEGIN
SELECT DEPARTMENT_ID INTO V_DEPARTMENT_ID FROM HRIS_DEPARTMENTS WHERE DEPARTMENT_ID=V_DEPARTMENT_LIST.DEPARTMENT_CODE;
DBMS_OUTPUT.PUT_LINE(V_DEPARTMENT_ID);
EXCEPTION
  WHEN NO_DATA_FOUND THEN
BEGIN

IF(V_DEPARTMENT_LIST.DELETED_FLAG='N') THEN
V_STATUS:='E';
ELSE
V_STATUS:='D';
END IF;


DBMS_OUTPUT.PUT(V_STATUS);

INSERT INTO HRIS_DEPARTMENTS
(DEPARTMENT_ID,DEPARTMENT_CODE,DEPARTMENT_NAME,REMARKS,CREATED_DT,STATUS,COUNTRY_ID)
VALUES
(V_DEPARTMENT_LIST.DEPARTMENT_CODE,
V_DEPARTMENT_LIST.DEPARTMENT_CODE,
V_DEPARTMENT_LIST.DEPARTMENT_EDESC,
V_DEPARTMENT_LIST.EREMARKS,
TRUNC(SYSDATE),
V_STATUS,
168
);


END;

END;

END LOOP;
END;